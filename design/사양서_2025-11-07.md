# JiraAuto Enhanced 사양서 (v2.0)

- 작성일: 2025-11-07
- 대상 OS: Windows 10/11
- Python: 3.11 권장
- 브라우저: Google Chrome

## 1. 개요

JIRA 버그 리포트 생성을 GUI 기반으로 단순화하고, Selenium을 통해 필드 입력/생성 과정을 자동화한다. 로컬 LLM(Ollama)을 사용한 AI 보조 생성 기능과, 프리셋/옵션(브랜치/빌드/픽스버전/컴포넌트) 관리 기능을 제공한다.

## 2. 아키텍처 개요

- UI 계층: `PyQt5` 기반 폼(`gui_widgets.py`) + 메인 윈도우 로직(`main_application.py`)
- 도메인/서비스: 프리셋/옵션/텍스트 처리/파일 IO(`utils.py`), 설정/상수(`config.py`)
- 외부 연동: Selenium 크롬 드라이버(`jira_automation.py`), 로컬 LLM Ollama(`ai_assistant.py`)
- 데이터: 프리셋(JSON, 버전 관리), 옵션(JSON), 최근 설정(`preset/settings.json`), 로그(`jira_auto.log`)

## 3. 주요 모듈 사양

### 3.1 `main_application.py`
- `BugReportApp(QWidget)`
  - 초기화: 로깅, 디렉터리 보장, 매니저 인스턴스 구성
  - UI 구성: `create_main_form` 호출 → 위젯 참조 저장/이벤트 연결/단축키 등록
  - 기능:
    - 설정 저장/로드(JSON)
    - 설명 자동 생성(템플릿)
    - AI 생성(비동기 스레드 `AIGenerationThread`) 진행 다이얼로그 포함
    - 프리셋 새로고침/적용/저장/삭제
    - 이슈 데이터 수집 → `jira_automation.create_issue` 실행(스레드)
  - 단축키: F2(실행), F5(프리셋 새로고침), F6(프리셋 적용), F12(디버그)

- `AIGenerationThread(QThread)`
  - 입력: summary, preset_dir
  - 처리: `get_ai_assistant` → `generate_bug_details` JSON 생성
  - 결과: `finished`(dict), `error`(str) 시그널

### 3.2 `gui_widgets.py`
- `FormBuilder`
  - Preset 섹션: 카테고리(prefix) → 이름(name) → 버전(version), 정렬 옵션(최신순/이름순), 저장/삭제/새로고침/적용 버튼
  - 필드: `FIELD_NAMES`(line/edit + summary 특수 처리), 콤보 필드(우선순위/심각도/발생범위/재현율), 텍스트 필드(Steps/Description)
  - 신규 콤보(+/-): `branch`, `build`, `fixversion`, `component` (편집 가능 + 옵션 저장/삭제)
  - 액션: Generate(템플릿), Execute(F2)
  - 메뉴바: About, Report Bugs 링크

### 3.3 `jira_automation.py`
- `ChromeDriverManager`
  - Chrome 실행 확인(디버깅 모드), 필요시 새 인스턴스 실행(`--remote-debugging-port`, `--user-data-dir`)
  - `chromedriver_autoinstaller`로 드라이버 설치
- `JiraAutomation`
  - 드라이버 연결/시작 → 새 탭 생성 후 전환
  - 흐름: JIRA 이동 → Create 버튼 클릭 → 폼 채움 → (일시정지로 사용자 확인) → 종료
  - 드롭다운 선택: send_keys / 클릭 / JS Click / RETURN 키 전략, 재시도 로직
- 편의 함수 `create_issue(**issue_data)` 제공

### 3.4 `config.py`
- 디렉터리/파일: `DIR_PRESET`, `SETTINGS_FILE`, `BUILD_NAME_FILE`, `FIX_VERSION_FILE`
- Chrome: 실행 파일 탐색, 디버그 포트/주소, 유저 데이터 디렉터리
- JIRA: `JIRA_BASE_URL`, `JiraXPaths` (모든 필드 XPath 상수)
- 드롭다운 옵션: Priority/Severity/Prevalence/Repro Rate/Generate 옵션
- 폼 필드 정의: `FIELD_NAMES`, `COMBO_FIELD_NAMES`, `OPTIONS_FILES`
- 스타일: 다크 테마 `DARK_THEME_STYLE`

### 3.5 `utils.py`
- 파일/JSON IO, 최근 수정 파일 조회, 로깅 설정
- 텍스트 치환 규칙 적용, 설명 템플릿 생성
- 옵션 매니저: 옵션 로드/저장/추가/삭제(JSON)
- 프리셋 매니저: 목록/그룹/버전 네이밍/저장/로드/삭제(버전 정렬 포함)

### 3.6 `ai_assistant.py`
- Ollama 연동(선택): 모델 존재 확인/목록 조회, 추천 모델 목록
- 프롬프트 생성 → `ollama.generate` 호출 → JSON 파싱(회복 로직 포함) → Priority/Severity/Steps/Description 반환
- 전역 싱글톤 `get_ai_assistant`

## 4. UI/필드 사양

- 기본 필드(`FIELD_NAMES`): `summary`(QTextEdit + sub_label), `team`, `linkedIssues`, `issue`, `parent`, `assignee`, `reviewer`, `label`
- 콤보 필드(드롭다운): `priority`, `severity`, `prevalence`, `repro_rate`
- 신규 콤보(+/-): `branch`, `build`, `fixversion`, `component` (편집 가능, 옵션 JSON 연동)
- 텍스트 필드: `Steps`, `Description`
- 부가 요소: `label` Include 체크박스, `build`/`fixversion` 파일 로드/저장 버튼
- 단축키: F2, F5, F6, F12

## 5. 동작 흐름

1) 앱 실행 → 프리셋/옵션 로드 → 폼 초기화
2) 사용자가 요약/필드 입력 → (선택) Generate/AI 생성으로 Description/Steps 자동화
3) Execute(F2) → JIRA 접속 → Create → 필드 자동 입력/선택 → 이슈 생성
4) 설정/프리셋 저장 및 종료 시 설정 자동 저장

## 6. 오류 처리/로그

- 로깅: 콘솔 + 파일(`jira_auto.log`)
- 파일/JSON 에러: 경고/오류 로그 후 안전 실패
- 드롭다운 선택 실패: 다중 전략/재시도 및 경고 로그
- AI 실패: 연결/모델/파싱 오류 메시지 및 회복 전략(정규식 추출)

## 7. 외부 의존성/환경

- 필수: `PyQt5`, `selenium`, `chromedriver-autoinstaller`, `requests`, `beautifulsoup4`, `lxml`
- 선택(AI): `ollama`
- Chrome 설치 필수, 디버깅 포트 9222 사용, 사용자 데이터 폴더 `C:\\ChromeTEMP`

## 8. 구성/설정 파일

- 프리셋 디렉터리: `preset/` (버전 파일명 규칙 지원)
- 옵션 파일: `branch_options.json`, `build_options.json`, `fixversion_options.json`, `component_options.json`
- 최근 설정: `preset/settings.json`
- 기타: `buildname.txt`, `fixversion.txt`

## 9. 보안/운영 고려사항

- JIRA URL/조직별 XPath 차이 가능 → `config.py` 조정 필요
- 크롬 경로/권한 문제 시 관리자 권한 또는 경로 수정 필요
- 테스트/운영 계정 분리 권장(자동 입력/제출)

## 10. 향후 개선 제안(선택)

- JIRA REST API 연동(웹 자동화 대체/보완)
- 프리셋/옵션 원격 동기화
- 다국어 UI 스위치, 사용자 권한/프로파일 지원
- 테스트 자동화(E2E) 및 상태 표시




